To do: make this not suck.
